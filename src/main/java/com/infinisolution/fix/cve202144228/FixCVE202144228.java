package com.infinisolution.fix.cve202144228;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;

import com.infinisolution.fix.BaseFix;

/**
 * Fix for CVE-2021-44228 <br/>
 * See https://logging.apache.org/log4j/2.x/ for more informations <br/>
 * the mitigation is to remove the JndiLookup class from the classpath: zip -q
 * -d log4j-core-*.jar org/apache/logging/log4j/core/lookup/JndiLookup.class.
 * 
 * @author InfiniSolution
 *
 */
public class FixCVE202144228 extends BaseFix {
	public static final String[] MALICIOUS_FILES = { "org/apache/logging/log4j/core/lookup/JndiLookup.class", "org/apache/log4j/net/JMSAppender.class" };

	public static void main(String[] args) throws FileNotFoundException, IOException {
		if (args.length != 1)
			throw new IllegalArgumentException("Need to have the location as first parameter");
		new FixCVE202144228().run(new File(args[0]));
	}

	@Override
	public String[] getMaliciousFile() {
		return MALICIOUS_FILES;
	}
}
